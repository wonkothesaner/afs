{"version":3,"sources":["../../../../server/auth/twitter/passport.js"],"names":[],"mappings":";;;;;;;;;wBAAqB,UAAU;;;;+BACW,kBAAkB;;AAErD,SAAS,KAAK,CAAC,IAAI,EAAE,MAAM,EAAE;AAClC,wBAAS,GAAG,CAAC,8BAAoB;AAC/B,eAAW,EAAE,MAAM,CAAC,OAAO,CAAC,QAAQ;AACpC,kBAAc,EAAE,MAAM,CAAC,OAAO,CAAC,YAAY;AAC3C,eAAW,EAAE,MAAM,CAAC,OAAO,CAAC,WAAW;GACxC,EACD,UAAS,KAAK,EAAE,WAAW,EAAE,OAAO,EAAE,IAAI,EAAE;AAC1C,QAAI,CAAC,YAAY,CAAC;AAChB,sBAAgB,EAAE,OAAO,CAAC,EAAE;KAC7B,CAAC,CACC,IAAI,CAAC,UAAA,IAAI,EAAI;AACZ,UAAI,IAAI,EAAE;AACR,eAAO,IAAI,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;OACzB;;AAED,UAAI,GAAG,IAAI,IAAI,CAAC;AACd,YAAI,EAAE,OAAO,CAAC,WAAW;AACzB,gBAAQ,EAAE,OAAO,CAAC,QAAQ;AAC1B,YAAI,EAAE,MAAM;AACZ,gBAAQ,EAAE,SAAS;AACnB,eAAO,EAAE,OAAO,CAAC,KAAK;OACvB,CAAC,CAAC;AACH,UAAI,CAAC,SAAS,EAAE,CACb,IAAI,CAAC,UAAA,IAAI;eAAI,IAAI,CAAC,IAAI,EAAE,IAAI,CAAC;OAAA,CAAC,SACzB,CAAC,UAAA,GAAG;eAAI,IAAI,CAAC,GAAG,CAAC;OAAA,CAAC,CAAC;KAC5B,CAAC,SACI,CAAC,UAAA,GAAG;aAAI,IAAI,CAAC,GAAG,CAAC;KAAA,CAAC,CAAC;GAC5B,CAAC,CAAC,CAAC;CACL","file":"passport.js","sourcesContent":["import passport from 'passport';\nimport {Strategy as TwitterStrategy} from 'passport-twitter';\n\nexport function setup(User, config) {\n  passport.use(new TwitterStrategy({\n    consumerKey: config.twitter.clientID,\n    consumerSecret: config.twitter.clientSecret,\n    callbackURL: config.twitter.callbackURL\n  },\n  function(token, tokenSecret, profile, done) {\n    User.findOneAsync({\n      'twitter.id_str': profile.id\n    })\n      .then(user => {\n        if (user) {\n          return done(null, user);\n        }\n\n        user = new User({\n          name: profile.displayName,\n          username: profile.username,\n          role: 'user',\n          provider: 'twitter',\n          twitter: profile._json\n        });\n        user.saveAsync()\n          .then(user => done(null, user))\n          .catch(err => done(err));\n      })\n      .catch(err => done(err));\n  }));\n}\n"]}